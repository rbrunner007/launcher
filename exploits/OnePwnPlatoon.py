#!/usr/bin/env python3

from Exploit import Exploit

# This is the port you want to run against
PORT = 42001

class Main(Exploit):
    # Name your file <classname>.py or else the launcher won't work
    def __init__(self, ip, debug=False):
        super().__init__("10.4.85.8", PORT, debug)

    def get_flag(self):
        # This is where you would write your own exploit code.
        self.recv()
        response = self.recv().strip().split()
        if len(response) != 0:
            flag = response[-1]
        else:
            flag = "doggo"

        # Return the flag as a string.
        return flag

    def send_chaff(self, quiet=True):
        # This is where you would write a fake exploit that does not really
        # work, but looks real enough to cause them to waste time looking for
        # the real exploit.

        line = self.recv()

        pass

